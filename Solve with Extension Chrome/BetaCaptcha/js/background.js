(()=>{let t="https://betacaptcha.com",e="";fetch(chrome.runtime.getURL("config.json")).then((t=>t.json())).then((t=>{e=t.API_KEY})),chrome.runtime.onMessage.addListener(((n,o,a)=>{if("get api key"===n.action)return chrome.storage.local.get(["api_key"],(function(n){let o=n.api_key||e;fetch(t+"/api/balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:o})}).then((t=>t.json())).then((t=>a({result:t,api_token:o}))).catch((t=>a({error:t.toString()})))})),!0;if("change api key"===n.action){let e=n.API_KEY;return chrome.storage.local.set({api_key:e},(function(){fetch(t+"/api/balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:e})}).then((t=>t.json())).then((t=>a({result:t,api_token:e}))).catch((t=>a({error:t.toString()})))})),!0}return"recaptcha"===n.action?(fetch(t+"/api/createJob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:e,data:{type_job:"recaptcha",sitekey:n.sitekey,siteurl:n.siteurl}})}).then((t=>t.json())).then((t=>a({result:t.taskid}))).catch((t=>a({error:t.toString()}))),!0):"funcaptcha"===n.action?(fetch(t+"/api/createJob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:e,data:{type_job:"fun_capcha_click",imginstructions:n.imginstructions,body:n.body}})}).then((t=>t.json())).then((t=>a({result:t.taskid}))).catch((t=>a({error:t.toString()}))),!0):"get_task_result"===n.action?(fetch(t+"/api/getJobResult",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:e,taskid:n.taskid})}).then((t=>t.json())).then((t=>a({result:t}))).catch((t=>a({error:t.toString()}))),!0):void 0}))})();